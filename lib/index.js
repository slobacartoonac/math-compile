!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.TypeMath=t():e.TypeMath=t()}(self,(()=>(()=>{"use strict";var e={738:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.evaluate=t.builtIn=t.NegateExp=void 0;const n=o(403),r=o(215);class i extends r.Exp{constructor(e){super(),this.expression=e}}t.NegateExp=i,t.builtIn={pi:Math.PI,e:Math.E},t.evaluate=function e(o,u={}){switch(!0){case o instanceof r.NoopExp:return 0;case o instanceof r.BinaryExp:let s=o;return function(e,t,o){switch(o){case n.TokenType.tok_op_plus:return e+t;case n.TokenType.tok_op_minus:return e-t;case n.TokenType.tok_op_multiply:return e*t;case n.TokenType.tok_op_devide:return e/t;case n.TokenType.tok_op_power:return Math.pow(e,t);case n.TokenType.tok_op_modulo:return e%t;default:throw new Error("Operation "+o+" unknown")}}(e(s.left,u),e(s.right,u),s.op);case o instanceof r.IdentifierExp:let p=o;return void 0!==u[p.value]?u[p.value]:void 0!==t.builtIn[p.value.toLowerCase()]?t.builtIn[p.value.toLowerCase()]:-1;case o instanceof r.NumberExp:return o.value;case o instanceof r.BracketsExp:return e(o.expression,u);case o instanceof i:return-e(o.expression,u);case o instanceof r.FunctionExp:let c=o;return function(e,t){switch(t){case r.FunctionType.sin:return Math.sin(e);case r.FunctionType.cos:return Math.cos(e);case r.FunctionType.tan:return Math.tan(e);case r.FunctionType.round:return Math.round(e);case r.FunctionType.floor:return Math.floor(e);case r.FunctionType.ceil:return Math.ceil(e);case r.FunctionType.abs:return Math.abs(e);case r.FunctionType.sqrt:return Math.sqrt(e);case r.FunctionType.exp:return Math.exp(e);case r.FunctionType.log:return Math.log(e);case r.FunctionType.log10:return Math.log10(e);default:throw new Error("Function "+t+" unknown")}}(e(c.expression,u),c.func);default:return-1}}},403:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Token=t.TokenType=t.tokenize=t.setInput=t.NumVal=t.IdentifierStr=t.getTokenElement=t.getNextToken=t.CurTok=void 0;const n=o(896);function r(){return t.CurTok=_()}function i(){switch(t.CurTok){case a.tok_identifier:return new k(a.tok_identifier,u.Col,u.Line,t.IdentifierStr);case a.tok_number:return new k(a.tok_number,u.Col,u.Line,"",t.NumVal);default:return new k(t.CurTok,u.Col,u.Line)}}t.getNextToken=r,t.getTokenElement=i;let u,s=" ",p={Line:1,Col:0};function c(e){f=e,s="",p={Line:1,Col:0},t.CurTok=null}var a;function l(){let e=function(){let e=f.split(""),t=e.shift();return void 0===t?(f="\0",n.EOF):(f=e.join(""),t)}();return"\n"==e||"\r"==e?(p.Line++,p.Col=0):p.Col++,e}t.setInput=c,t.tokenize=function(e){c(e);let o=[];for(;t.CurTok!=a.tok_eof;)r(),o.push(i());return o},function(e){e.tok_eof="tok_eof",e.tok_identifier="tok_identifier",e.tok_number="tok_number",e.tok_op_plus="tok_op_plus",e.tok_op_minus="tok_op_minus",e.tok_op_multiply="tok_op_multiply",e.tok_op_devide="tok_op_devide",e.tok_op_power="tok_op_power",e.tok_op_modulo="tok_op_modulo",e.tok_open="tok_open",e.tok_close="tok_close"}(a=t.TokenType||(t.TokenType={}));class k{constructor(e,t,o,n="",r=0){this.tokenType=e,this.column=t,this.line=o,this.str=n,this.value=r}}t.Token=k;let f="";function _(){for(;(0,n.isspace)(s);)s=l();if(u=p,(0,n.isalpha)(s)){for(t.IdentifierStr=s;(0,n.isalnum)(s=l());)t.IdentifierStr+=s;return a.tok_identifier}if((0,n.isdigit)(s)||"."==s){let e="";do{e+=s,s=l()}while((0,n.isdigit)(s)||"."==s);return t.NumVal=(0,n.strtod)(e),a.tok_number}if("+"==s)return s=l(),a.tok_op_plus;if("-"==s)return s=l(),a.tok_op_minus;if("*"==s)return s=l(),a.tok_op_multiply;if("/"==s)return s=l(),a.tok_op_devide;if("^"==s)return s=l(),a.tok_op_power;if("%"==s)return s=l(),a.tok_op_modulo;if(["{","[","("].includes(s))return s=l(),a.tok_open;if(["}","]",")"].includes(s))return s=l(),a.tok_close;if("#"==s){do{s=l()}while(s!=n.EOF&&"\n"!=s&&"\r"!=s);if(s!=n.EOF)return _()}if(s==n.EOF)return a.tok_eof;let e=s;throw s=l(),Error("Undefined token"+e+" ( "+e.charCodeAt(0)+" ) at: "+JSON.stringify(u))}},215:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseProgram=t.FunctionExp=t.BinaryExp=t.IdentifierExp=t.NumberExp=t.BracketsExp=t.NegateExp=t.NoopExp=t.Exp=t.functionList=t.FunctionType=void 0;const n=o(403);let r,i,u=0;function s(){return u++,r.length<=u?(u=r.length-1,new n.Token(n.TokenType.tok_eof,0,0)):(i=r[u],r[u])}function p(){return r[u]}function c(e){return p().tokenType===e}var a;!function(e){e[e.sin=0]="sin",e[e.cos=1]="cos",e[e.tan=2]="tan",e[e.round=3]="round",e[e.floor=4]="floor",e[e.ceil=5]="ceil",e[e.abs=6]="abs",e[e.sqrt=7]="sqrt",e[e.exp=8]="exp",e[e.log=9]="log",e[e.log10=10]="log10"}(a=t.FunctionType||(t.FunctionType={})),t.functionList=Object.keys(a);class l{}t.Exp=l,t.NoopExp=class extends l{};class k extends l{constructor(e){super(),this.expression=e}}t.NegateExp=k;class f extends l{constructor(e){super(),this.expression=e}}t.BracketsExp=f;class _ extends l{constructor(e){super(),this.value=e}}t.NumberExp=_;class T extends l{constructor(e){super(),this.value=e}}t.IdentifierExp=T;class d extends l{constructor(e,t,o){super(),this.left=e,this.right=t,this.op=o}}t.BinaryExp=d;class y extends l{constructor(e,t){super(),this.expression=e,this.func=t}}t.FunctionExp=y;class x extends l{constructor(e){super(),this.priority=function(e){return{[n.TokenType.tok_op_plus]:1,[n.TokenType.tok_op_minus]:1,[n.TokenType.tok_op_multiply]:2,[n.TokenType.tok_op_devide]:2,[n.TokenType.tok_op_modulo]:4,[n.TokenType.tok_op_power]:5}[e]}(e),this.op=e}}function h(e){var o,r,i;if(c(n.TokenType.tok_eof)||c(n.TokenType.tok_close))return null;if(e&&[n.TokenType.tok_op_plus,n.TokenType.tok_op_minus,n.TokenType.tok_op_multiply,n.TokenType.tok_op_devide,n.TokenType.tok_op_modulo,n.TokenType.tok_op_power].includes(p().tokenType)){var u=p().tokenType;return s(),u==n.TokenType.tok_op_multiply&&p().tokenType==n.TokenType.tok_op_multiply?(s(),new x(n.TokenType.tok_op_power)):new x(u)}if(c(n.TokenType.tok_open))return function(){s();let e=m();return s(),new f(e)}();if(c(n.TokenType.tok_op_minus))return s(),new k(m());if(c(n.TokenType.tok_op_plus))return s(),h(e);if(c(n.TokenType.tok_identifier)){let e=(null===(o=p())||void 0===o?void 0:o.str)||"";if(s(),i=e,t.functionList.includes(i.toLowerCase())){let t=e;return new y(m(),a[t])}return new T(e)}let l=(null===(r=p())||void 0===r?void 0:r.value)||0;return s(),new _(l)}function m(){let e=null,t=[];for(;!c(n.TokenType.tok_eof)&&!c(n.TokenType.tok_close);)t.push(h(t[t.length-1]));for(;t.length>1;){const e=(o=void 0,void 0,o=t.map((function(e){return e instanceof x?e.priority:0})),r=Math.max.apply(Math,o),o.indexOf(r)),n=t[e],i=t[e-1],u=t[e+1];t.splice(e-1,3,new d(i,u,n.op))}var o,r;return e=t[0],e||new _(0)}t.parseProgram=function(e){return r=(0,n.tokenize)(e),u=0,m()}},896:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EOF=t.strtod=t.isalpha=t.isalnum=t.isdigit=t.isspace=void 0,t.isspace=function(e){return/\s/.test(e)||""==e},t.isdigit=function(e){return/[0-9]/.test(e)},t.isalnum=function(e){return/[a-zA-Z0-9]/.test(e)},t.isalpha=function(e){return/[a-zA-Z]/.test(e)},t.strtod=function(e){let t=parseFloat(e);return isNaN(t)?0:t},t.EOF="\0"}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,o),i.exports}var n={};return(()=>{var e=n;Object.defineProperty(e,"__esModule",{value:!0}),e.parseProgram=e.evaluate=e.execute=void 0;const t=o(215);Object.defineProperty(e,"parseProgram",{enumerable:!0,get:function(){return t.parseProgram}});const r=o(738);Object.defineProperty(e,"evaluate",{enumerable:!0,get:function(){return r.evaluate}});let i={};e.execute=function(e,o={}){let n="",u=0;try{let n=new t.NoopExp;i[e]?n=i[e]:(n=(0,t.parseProgram)(e),i[e]=n),u=(0,r.evaluate)(n,o)}catch(e){n=e.toString()}return{res:u,err:n}}})(),n})()));