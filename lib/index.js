!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.TypeMath=t():e.TypeMath=t()}(self,(()=>(()=>{"use strict";var e={738:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.evaluate=t.builtIn=void 0;const o=n(403),r=n(215);t.builtIn={pi:Math.PI,e:Math.E},t.evaluate=function e(n,i={}){switch(!0){case n instanceof r.NoopExp:return 0;case n instanceof r.BinaryExp:let u=n;return function(e,t,n){switch(n){case o.TokenType.tok_op_plus:return e+t;case o.TokenType.tok_op_minus:return e-t;case o.TokenType.tok_op_multiply:return e*t;case o.TokenType.tok_op_devide:return e/t;case o.TokenType.tok_op_power:return Math.pow(e,t);case o.TokenType.tok_op_modulo:return e%t;default:throw new Error("Operation "+n+" unknown")}}(e(u.left,i),e(u.right,i),u.op);case n instanceof r.IdentifierExp:let s=n;return void 0!==i[s.value]?i[s.value]:void 0!==t.builtIn[s.value.toLowerCase()]?t.builtIn[s.value.toLowerCase()]:-1;case n instanceof r.NumberExp:return n.value;case n instanceof r.BracketsExp:return e(n.expression,i);case n instanceof r.NegateExp:return-e(n.expression,i);case n instanceof r.FunctionExp:let a=n;return function(e,t){switch(t){case r.FunctionType.sin:return Math.sin(e);case r.FunctionType.asin:return Math.asin(e);case r.FunctionType.sinh:return Math.sinh(e);case r.FunctionType.asinh:return Math.asinh(e);case r.FunctionType.cos:return Math.cos(e);case r.FunctionType.acos:return Math.acos(e);case r.FunctionType.cosh:return Math.cosh(e);case r.FunctionType.acos:return Math.acos(e);case r.FunctionType.acosh:return Math.acosh(e);case r.FunctionType.tan:return Math.tan(e);case r.FunctionType.atan:return Math.atan(e);case r.FunctionType.tanh:return Math.tanh(e);case r.FunctionType.atanh:return Math.atanh(e);case r.FunctionType.round:return Math.round(e);case r.FunctionType.floor:return Math.floor(e);case r.FunctionType.ceil:return Math.ceil(e);case r.FunctionType.abs:return Math.abs(e);case r.FunctionType.sqrt:return Math.sqrt(e);case r.FunctionType.exp:return Math.exp(e);case r.FunctionType.ln:case r.FunctionType.log:return Math.log(e);case r.FunctionType.log10:return Math.log10(e);case r.FunctionType.factorial:return(n=e)%1?function(e){for(var t=e+1,n=Math.pow(25,e),o=1;o<25;o++)n*=o/t++;return n}(n):function(e){var t=e;if(0===e||1===e)return 1;for(;e>1;)t*=--e;return t}(n);default:throw new Error("Function "+t+" unknown")}var n}(e(a.expression,i),a.func);default:return-1}}},403:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Token=t.TokenType=t.tokenize=t.setInput=t.NumVal=t.IdentifierStr=t.getTokenElement=t.getNextToken=t.CurTok=void 0;const o=n(896);function r(){return t.CurTok=_()}function i(){switch(t.CurTok){case c.tok_identifier:return new f(c.tok_identifier,u.Col,u.Line,t.IdentifierStr);case c.tok_number:return new f(c.tok_number,u.Col,u.Line,"",t.NumVal);default:return new f(t.CurTok,u.Col,u.Line)}}t.getNextToken=r,t.getTokenElement=i;let u,s=" ",a={Line:1,Col:0};function p(e){k=e,s="",a={Line:1,Col:0},t.CurTok=null}var c;function l(){let e=function(){let e=k.split(""),t=e.shift();return void 0===t?(k="\0",o.EOF):(k=e.join(""),t)}();return"\n"==e||"\r"==e?(a.Line++,a.Col=0):a.Col++,e}t.setInput=p,t.tokenize=function(e){p(e);let n=[];for(;t.CurTok!=c.tok_eof;)r(),n.push(i());return n},function(e){e.tok_eof="tok_eof",e.tok_identifier="tok_identifier",e.tok_number="tok_number",e.tok_op_plus="tok_op_plus",e.tok_op_minus="tok_op_minus",e.tok_op_multiply="tok_op_multiply",e.tok_op_devide="tok_op_devide",e.tok_op_power="tok_op_power",e.tok_op_modulo="tok_op_modulo",e.tok_open="tok_open",e.tok_close="tok_close",e.tok_op_factorial="tok_op_factorial"}(c=t.TokenType||(t.TokenType={}));class f{constructor(e,t,n,o="",r=0){this.tokenType=e,this.column=t,this.line=n,this.str=o,this.value=r}}t.Token=f;let k="";function _(){for(;(0,o.isspace)(s);)s=l();if(u=a,(0,o.isalpha)(s)){for(t.IdentifierStr=s;(0,o.isalnum)(s=l());)t.IdentifierStr+=s;return c.tok_identifier}if((0,o.isdigit)(s)||"."==s){let e="";do{e+=s,s=l()}while((0,o.isdigit)(s)||"."==s);return t.NumVal=(0,o.strtod)(e),c.tok_number}if("+"==s)return s=l(),c.tok_op_plus;if("-"==s)return s=l(),c.tok_op_minus;if("*"==s)return s=l(),c.tok_op_multiply;if("/"==s)return s=l(),c.tok_op_devide;if("^"==s)return s=l(),c.tok_op_power;if("%"==s)return s=l(),c.tok_op_modulo;if("!"==s)return s=l(),c.tok_op_factorial;if(["{","[","("].includes(s))return s=l(),c.tok_open;if(["}","]",")"].includes(s))return s=l(),c.tok_close;if("#"==s){do{s=l()}while(s!=o.EOF&&"\n"!=s&&"\r"!=s);if(s!=o.EOF)return _()}if(s==o.EOF)return c.tok_eof;let e=s;throw s=l(),Error("Undefined token"+e+" ( "+e.charCodeAt(0)+" ) at: "+JSON.stringify(u))}},215:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseProgram=t.FactorialExpCandidate=t.FunctionExp=t.BinaryExp=t.IdentifierExp=t.NumberExp=t.BracketsExp=t.NegateExp=t.NoopExp=t.Exp=t.functionList=t.FunctionType=void 0;const o=n(403);let r,i,u=0;function s(){return u++,r.length<=u?(u=r.length-1,new o.Token(o.TokenType.tok_eof,0,0)):(i=r[u],r[u])}function a(){return r[u]}function p(e){return a().tokenType===e}var c;!function(e){e[e.sin=0]="sin",e[e.asin=1]="asin",e[e.sinh=2]="sinh",e[e.asinh=3]="asinh",e[e.cos=4]="cos",e[e.acos=5]="acos",e[e.cosh=6]="cosh",e[e.acosh=7]="acosh",e[e.tan=8]="tan",e[e.atan=9]="atan",e[e.tanh=10]="tanh",e[e.atanh=11]="atanh",e[e.round=12]="round",e[e.floor=13]="floor",e[e.ceil=14]="ceil",e[e.abs=15]="abs",e[e.sqrt=16]="sqrt",e[e.exp=17]="exp",e[e.log=18]="log",e[e.log10=19]="log10",e[e.ln=20]="ln",e[e.factorial=21]="factorial"}(c=t.FunctionType||(t.FunctionType={})),t.functionList=Object.keys(c);class l{}t.Exp=l,t.NoopExp=class extends l{};class f extends l{constructor(e){super(),this.expression=e}}t.NegateExp=f;class k extends l{constructor(e){super(),this.expression=e}}t.BracketsExp=k;class _ extends l{constructor(e){super(),this.value=e}}t.NumberExp=_;class T extends l{constructor(e){super(),this.value=e}}t.IdentifierExp=T;class d extends l{constructor(e,t,n){super(),this.left=e,this.right=t,this.op=n}}t.BinaryExp=d;class y extends l{constructor(e,t){super(),this.expression=e,this.func=t}}t.FunctionExp=y;class h extends l{}t.FactorialExpCandidate=h;class x extends l{constructor(e){super(),this.priority=function(e){return{[o.TokenType.tok_op_plus]:1,[o.TokenType.tok_op_minus]:1,[o.TokenType.tok_op_multiply]:2,[o.TokenType.tok_op_devide]:2,[o.TokenType.tok_op_modulo]:4,[o.TokenType.tok_op_power]:5}[e]}(e),this.op=e}}function m(e){var n,r,i;if(p(o.TokenType.tok_eof)||p(o.TokenType.tok_close))return null;if(e&&!(e instanceof x)&&function(e=a().tokenType){return[o.TokenType.tok_op_plus,o.TokenType.tok_op_minus,o.TokenType.tok_op_multiply,o.TokenType.tok_op_devide,o.TokenType.tok_op_modulo,o.TokenType.tok_op_power].includes(e)}()){var u=a().tokenType;return s(),u==o.TokenType.tok_op_multiply&&a().tokenType==o.TokenType.tok_op_multiply?(s(),new x(o.TokenType.tok_op_power)):new x(u)}if(p(o.TokenType.tok_op_minus))return s(),new f(w());if(p(o.TokenType.tok_op_plus))return s(),m(e);if(e){if(p(o.TokenType.tok_op_factorial))return s(),new h;if(!(e instanceof x))return new x(o.TokenType.tok_op_multiply)}if(p(o.TokenType.tok_open))return function(){s();let e=w();return s(),new k(e)}();if(p(o.TokenType.tok_identifier)){let e=(null===(n=a())||void 0===n?void 0:n.str)||"";if(s(),i=e,t.functionList.includes(i.toLowerCase())){let t=e;return new y(m(),c[t])}return new T(e)}if(p(o.TokenType.tok_number)){let e=(null===(r=a())||void 0===r?void 0:r.value)||0;return s(),new _(e)}throw new Error("Unexpected token: "+a().tokenType+` at: (${a().column},${a().line})`)}function v(e){return e.findIndex((function(e){return e instanceof h}))}function w(){let e=null,t=[];for(;!p(o.TokenType.tok_eof)&&!p(o.TokenType.tok_close);)t.push(m(t[t.length-1]));let n=v(t);for(;n>-1;){const e=t[n-1];t.splice(n-1,2,new y(e,c.factorial)),n=v(t)}for(;t.length>1;){const e=(r=void 0,void 0,r=t.map((function(e){return e instanceof x?e.priority:0})),i=Math.max.apply(Math,r),r.indexOf(i)),n=t[e],o=t[e-1],u=t[e+1];t.splice(e-1,3,new d(o,u,n.op))}var r,i;return e=t[0],e||new _(0)}t.parseProgram=function(e){return r=(0,o.tokenize)(e),u=0,w()}},896:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EOF=t.strtod=t.isalpha=t.isalnum=t.isdigit=t.isspace=void 0,t.isspace=function(e){return/\s/.test(e)||""==e},t.isdigit=function(e){return/[0-9]/.test(e)},t.isalnum=function(e){return/[a-zA-Z0-9]/.test(e)},t.isalpha=function(e){return/[a-zA-Z]/.test(e)},t.strtod=function(e){let t=parseFloat(e);return isNaN(t)?0:t},t.EOF="\0"}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var i=t[o]={exports:{}};return e[o](i,i.exports,n),i.exports}var o={};return(()=>{var e=o;Object.defineProperty(e,"__esModule",{value:!0}),e.parseProgram=e.evaluate=e.execute=void 0;const t=n(215);Object.defineProperty(e,"parseProgram",{enumerable:!0,get:function(){return t.parseProgram}});const r=n(738);Object.defineProperty(e,"evaluate",{enumerable:!0,get:function(){return r.evaluate}});let i={};e.execute=function(e,n={}){let o="",u=0;try{let o=new t.NoopExp;i[e]?o=i[e]:(o=(0,t.parseProgram)(e),i[e]=o),u=(0,r.evaluate)(o,n)}catch(e){o=e.toString()}return{res:u,err:o}}})(),o})()));